<html>
    <head>
        <meta charset="utf-8">

        <!-- Load d3.js -->
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

        <!-- Load stylesheets -->
        <link rel='stylesheet' type='text/css' href='./stylesheets/header-slide-navigation.css'>
        <link rel='stylesheet' type='text/css' href='./stylesheets/tooltip.css'>
    </head>

    <style></style>
    <body class="body-main">
        <div class="main-header">
            <h1 class="header-text">Is India Slowing Its Population Growth?</h1>
            <h6 class="header-text-footer">Data Visualization Aassignment - University Of Illinois - MSDS</h6>
            <img class="img-class" src="./images/IndiaMumbai_Population_4.jpg">
        </div>
        <hr>
        <div class="main-navigation">
            <a href="file:///Users/rajkulkarni/Documents/GitHub/rajlakshmank.github.io/scene2.html" class="next">Next &raquo;</a>
        </div>

        
        <h3>India In World Population</h3>
        
        <!-- Add 2 buttons -->
        <button onclick="update('population')">Population</button>
        <button onclick="update('fert_rate')">Fertility Rate</button>


        <!-- Create a div where the scene1 graph will take place -->
        
        <div id="scene_1_dataviz">
            <div class="para-text">
                <p>sakhdshksfdsfkhdfhkdkhfdhfghkdsbvkhdabvhdvhdsv
                    ldfldjfdjnfjdsf
                    dkfkd
                </p>
            </div>
            
        </div>


    </body>
    
    <script>
        // set the dimensions and margins of the graph
        var margin = {top: 50, right: 30, bottom: 80, left: 70},
        width = 550 - margin.left - margin.right,
        height = 550 - margin.top - margin.bottom;

        // append the svg object to the body of the page
        var svg = d3.select("#scene_1_dataviz")
                    .append("svg")
                    .attr("class","svg1")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("class","svg1 Group1")
                    .attr("transform","translate(" + margin.left + "," + margin.top + ")");

        // Initialize the X axis
        var x = d3.scaleBand()
                    .range([ 0, width ])
                    .padding(.2);
        var xAxis = svg.append("g")
                    .attr("class", "myXaxis")
                    .attr("transform", "translate(0," + height + ")")

        // Initialize the Y axis
        var y = d3.scaleLinear()
                    .range([ height, 0]);
        var yAxis = svg.append("g")
                    .attr("class", "myYaxis")

        // Color scale
        var color = d3.scaleOrdinal(d3.schemeTableau10);

        // tooltips
        var div = d3.select('#scene_1_dataviz').append('div')
            .attr('class', 'tooltip')
            .style('display', 'none');
            
        //var selectedVar1 = "population"
        // Parse the Data
        

        function update(selectedVar) {

            d3.csv("https://raw.githubusercontent.com/rajlakshmank/rajlakshmank.github.io/master/data/top-10-countries-population-data.csv", function(data) {

                console.log("function update - selectedVar: " + selectedVar);
                // X axis
                x.domain(data.map(function(d) { return d.country; }))
                xAxis
                    .transition()
                    .duration(1000)
                    .call(d3.axisBottom(x))
                    .selectAll("text")
                    .attr("transform", "translate(-10,10)rotate(-45)")
                    .style("text-anchor", "end")
                    .style("font-size", 10)
                    .style("fill", "#69a3b2")

                // Add Y axis
                y.domain([0, d3.max(data, function(d) { return +d[selectedVar] }) ]);
                yAxis
                    .transition()
                    .duration(1000)
                    .call(d3.axisLeft(y))
                    .selectAll("text")
                    .style("text-anchor", "end")
                    .style("font-size", 10)
                    .style("fill", "#69a3b2");


                //color.domain([d3.min(data, function(d) { return +d[selectedVar] }), d3.max(data, function(d) { return +d[selectedVar] })]);
                //Bind data to non existant rectangles
                var bars = svg.selectAll("rect")
                    .data(data)
                    
                bars
                    .enter()
                    .append("rect")
                    .attr("class", "bar rect")
                    .attr("x", function(d) { return x(d.country); })
                    .attr("y", function(d) { return y(d[selectedVar]); })
                    .attr("width", x.bandwidth())
                    .attr("height", function(d) { return height - y(d[selectedVar]); })
                    //.attr("fill", "#69b3a2")
                    .attr("fill", function(d) { return color(d.country); })
                    .on("mouseover", onMouseOver)
                    .on("mouseout", OnMouseOut)

                bars
                    .transition()
                    .duration(1000)
                    .attr("x", function(d) { return x(d.country); })
                    .attr("y", function(d) { return y(d[selectedVar]); })
                    .attr("width", x.bandwidth())
                    .attr("height", function(d) { return height - y(d[selectedVar]); })
                    //.attr("fill", "#69b3a2")
                    .attr("fill", function(d) { return color(d.country); })

                function onMouseOver() {
                    console.log("Mouse Over - selectedVar: " + selectedVar);
                    d3.select(this).attr("fill", "gray");
                    var d = d3.select(this).data()[0]
                    div
                        .style('display', 'inline')
                        .html(d.country + '<hr/>' + d[selectedVar])
                        .style('left', (d3.event.pageX - 34) + 'px')
                        .style('top', (d3.event.pageY - 12) + 'px');
                }
                function OnMouseOut() {
                    d3.select(this).attr("fill", function(d) { return color(d.country); });
                    div.style('display', 'none');
                    
                }
                
            })
        
        }

        update("population");

    </script>
</html>