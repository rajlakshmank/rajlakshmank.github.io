<html lang="en">
    <head>
        <title>DV Slide 1</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <!-- Load d3.js -->
        <script src="https://d3js.org/d3.v4.min.js"></script>

        <!-- Load stylesheets -->
        <link rel='stylesheet' type='text/css' href='./stylesheets/page-style.css'>
    </head>
    <body>
        <div class="header">
            <h1>Is India Slowing Its Population Growth?</h1>
            <p class="header-text-footer-1">Data Visualization Aassignment - UIUC - MSDS</p>
            <p class="header-text-footer-2">by Rajlakshman Kulkarni</p>
        </div>

        <div class="navbar">
            <a href="https://rajlakshmank.github.io/dv_slide2.html" class="right">Next &raquo;</a>
            <a href="https://rajlakshmank.github.io/dv_slide1.html" class="right">Home</a>
          </div>

        <div class="row">
            <div class="column">
                <article class="dv_article">
                    <article class="dv_article_main">
                        <p>
                            <b>“Hum Do Hamare Do”</b> which means <b>“We Two, Ours Two”</b> <br> A family planning initiative launched by 
                            the government of India in 1952 which encouraged couples to have at most two kids. Every government 
                            thereafter crafted a range of population policies for Indians to have smaller families. 
                            By 2027, India is set to surpass China as the world's most populous country as per United Nations projects. 
                            Is India taking necessary measures and making progress in slowing its population growth?
                        </p> 
                        <hr>
                    </article>
                    <h3 class="article_header">India In World Population</h3>
                    <p>
                        India in world population now has 1.37 billion people - second only to China 1.4 billion. 
                        China and India together contribute half of the world population. At present, one out of every six persons 
                        in the world is from India. Among the 10 most populated countries, India and Bangladesh top the chart on 
                        higher population density. India has just 2.4% world surface but supports and sustains a 
                        whooping 17.5% of the world population. At the current rate it's been estimated that India’s population will 
                        peak in the early 2060’s at 1.7 billion, putting additional pressure on the environment, natural resources 
                        and economy. Hence curbing population growth definitely promises a better future for its citizens.
                    </p>
                    <p>
                        These alarming statistics hide a more complex reality, and some positive trends. For the past few decades 
                        population growth rate has been slowing down among 10 most populous countries and the rest of the world. 
                        Pakistan and Nigeria are outliers, for which fertility rates are above replacement level and rest have hit 
                        the replacement level. Hence proving fertility rate plays an important role among all 
                        social and economical indicators in slowing down population growth.
                    </p>
                    <p>
                        As in much of the rest of the world, India has shown a positive trend in the current decade and it is expected 
                        to hit replacement fertility level by 2021. But behind that statistic lies more complex reality. 
                    </p>
                    <p>
                        Chart 1 animates and depicts population, population density and fertility rates for ten most populous countries of the world. 
                        Chart 2 on the other hand shows population growth rate for these countries from 1960.
                    </p>
                </article>
            </div>
            <div class="column">
                <h2 class="graph_header">Top Ten Countries In The World By Population</h2>
                <div class="graph_buttons">
                    <button class="button" onclick="update('pop_in_b')">Population</button>
                    <button class="button" onclick="update('density')">Population Density</button>
                    <button class="button" onclick="update('fert_rate')">Fertility Rate</button>
                </div>
                <div id="scene_1_dv1"></div>
                <hr>
                <h2 class="graph_header">Population Growth Rate Trajectories</h2>
                <div class="graph_buttons">
                    <button class="button" onclick="playLineChart()">Play</button>
                </div>
                <div id="scene_1_dv2">
                </div>
            </div>
        </div>

        <div class="navbar">
            <a href="https://rajlakshmank.github.io/dv_slide2.html" class="right">Next &raquo;</a>
            <a href="https://rajlakshmank.github.io/dv_slide1.html" class="right">Home</a>
        </div>

        <div class="footer">
            <h4>Reference - https://e360.yale.edu/features/why-india-is-making-progress-in-slowing-its-population-growth </h4>
            <h4>Data Curtacy - https://data.worldbank.org </h4>
            <h4>DataViz by Rajlakshman Kulkarni</h4>
        </div>
    </body>
    <script>
        // set the dimensions and margins of the graph
        var dv1_margin = {top: 20, right: 30, bottom: 80, left: 70},
        dv1_width = 550 - dv1_margin.left - dv1_margin.right,
        dv1_height = 450 - dv1_margin.top - dv1_margin.bottom;

        // append the svg object to the body of the page
        var dv1_svg = d3.select("#scene_1_dv1")
                    .append("svg")
                    .attr("class","dv1-svg1")
                    .attr("width", dv1_width + dv1_margin.left + dv1_margin.right)
                    .attr("height", dv1_height + dv1_margin.top + dv1_margin.bottom)
                    .append("g")
                    .attr("class","dv1 svg1 Group1")
                    .attr("transform","translate(" + dv1_margin.left + "," + dv1_margin.top + ")");

        

        // Initialize the X axis
        var dv1_x = d3.scaleBand()
                    .range([ 0, dv1_width ])
                    .padding(.2);
        var dv1_xAxis = dv1_svg.append("g")
                    .attr("class", "dv1 X-axis")
                    .attr("transform", "translate(0," + dv1_height + ")")

        // Initialize the Y axis
        var dv1_y = d3.scaleLinear()
                    .range([ dv1_height, 0]);
        var dv1_yAxis = dv1_svg.append("g")
                    .attr("class", "dv1 Y-axis")

        // Color scale
        //var dv1_color = d3.scaleOrdinal(d3.schemeTableau10);
        var dv1_color = d3.scaleOrdinal(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"]);
        // tooltips
        var dv1_tooltip = d3.select('#scene_1_dv1')
                    .append('div')
                    .attr('class', 'dv1 tooltip')
                    .style('display', 'none');
            
        var selectedVar = "pop_in_b"
    
        var dv1_url = "https://raw.githubusercontent.com/rajlakshmank/rajlakshmank.github.io/master/data/top-10-countries-population-data.csv"
        
        update(selectedVar);

        function update(selectedVar) {

            dv1_annotations(selectedVar);

            d3.csv(dv1_url, function(dv1_data) {

                console.log(dv1_data);
                //console.log("function update - selectedVar: " + selectedVar);
                
                // X axis
                dv1_x.domain(dv1_data.map(function(d) { return d.country; }))
                dv1_xAxis
                    .transition()
                    .duration(1000)
                    .call(d3.axisBottom(dv1_x))
                    .selectAll("text")
                    .attr("transform", "translate(-10,10)rotate(-45)")
                    .attr("class","graph_axis_text")


                // Add Y axis
                dv1_y.domain([0, d3.max(dv1_data, function(d) { return +d[selectedVar] }) ]);
                dv1_yAxis
                    .transition()
                    .duration(1000)
                    .call(d3.axisLeft(dv1_y))
                    .selectAll("text")
                    .attr("class","graph_axis_text")
                    //.style("fill", "#69a3b2");
                
                //Y-axis title
                dv1_yAxis_text = "Population in Billion"
                if (selectedVar == "pop_in_b") {
                    dv1_yAxis_text = "Population in billion"
                }
                if (selectedVar == "density") {
                    dv1_yAxis_text = "Population density"
                }
                if (selectedVar == "fert_rate") {
                    dv1_yAxis_text = "% Fertility rate"
                }
                dv1_svg.selectAll(".dv1_graph_axis_title").remove();
                dv1_svg
                    .append("text")
                    .attr("class", "dv1_graph_axis_title")
                    .attr("transform", "rotate(-90)")
                    .attr("y", -dv1_margin.left+20)
                    .attr("x", -dv1_margin.top-60)
                    .text(dv1_yAxis_text);
                

                //color.domain([d3.min(data, function(d) { return +d[selectedVar] }), d3.max(data, function(d) { return +d[selectedVar] })]);
                //Bind data to non existant rectangles
                var dv1_bars = dv1_svg.selectAll("rect")
                    .data(dv1_data)
                    
                dv1_bars
                    .enter()
                    .append("rect")
                    .attr("class", "dv1 bar rect")
                    .attr("x", function(d) { return dv1_x(d.country); })
                    .attr("y", function(d) { return dv1_y(d[selectedVar]); })
                    .attr("width", dv1_x.bandwidth())
                    .attr("height", function(d) { return dv1_height - dv1_y(d[selectedVar]); })
                    .attr("fill", function(d) { return dv1_color(d.country); })
                    .on("mouseover", dv1_onMouseOver)
                    .on("mouseout", dv1_OnMouseOut)

                dv1_bars
                    .transition()
                    .duration(1000)
                    .attr("x", function(d) { return dv1_x(d.country); })
                    .attr("y", function(d) { return dv1_y(d[selectedVar]); })
                    .attr("width", dv1_x.bandwidth())
                    .attr("height", function(d) { return dv1_height - dv1_y(d[selectedVar]); })
                    .attr("fill", function(d) { return dv1_color(d.country); })

                function dv1_onMouseOver() {
                    d3.select(this).attr("fill", "black");
                    var d = d3.select(this).data()[0]
                    dv1_tooltip
                        .style('display', 'inline')
                        .html(d.country + '<hr/>' + "Population: " + d.population + '<br>' + "Density: " + d.density + '<br>' + "Fertility Rate: " + d.fert_rate + '<br>' +"Land Area: " +  d.land_area + '<br>' +"Median Age: " +  d.med_age)
                        .style('left', (d3.event.pageX))
                        .style('top', (d3.event.pageY));
                }
                function dv1_OnMouseOut() {
                    d3.select(this).attr("fill", function(d) { return dv1_color(d.country); });
                    dv1_tooltip.style('display', 'none');
                    
                }
                
            })
        
        }

        function dv1_annotations(selectedVar) {

            d3.select(".dv1-svg1").select(".dv1-anntn-group").remove()

             // Graph1 annotations
            var dv1_anntn_group = d3.select(".dv1-svg1").append("g").attr("class","dv1-anntn-group");

            var ant_delay = 2000;
            // Add annotation to the chart
            if (selectedVar == "pop_in_b") {

                dv1_anntn_group
                    .append("path")
                    .attr("class","dv1-anntn-1-path1 annotation-path")
                    .attr("d", "M150,160L240,110L420,110")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-1-text1 annotation-text-title")
                    .attr("x", 240)
                    .attr("y", 80)
                    .text("India")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
                
                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-1-text2 annotation-text")
                    .attr("x", 240)
                    .attr("y", 100)
                    .text("2nd most populous contry")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

            }
            else if (selectedVar == "density") {

                dv1_anntn_group
                    .append("path")
                    .attr("class","dv1-anntn-2-path1 annotation-path")
                    .attr("d", "M140,260L150,130L350,130L410,180")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-2-text1 annotation-text-title")
                    .attr("x", 150)
                    .attr("y", 80)
                    .text("India & Bangladesh")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
                
                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-2-text2 annotation-text")
                    .attr("x", 150)
                    .attr("y", 100)
                    .text("Contries with high population")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
                
                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-2-text2 annotation-text")
                    .attr("x", 150)
                    .attr("y", 120)
                    .text("density")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
                
            }
            else {
                dv1_anntn_group
                    .append("path")
                    .attr("class","dv1-anntn-3-path1 annotation-path")
                    .attr("d", "M140,260L100,110L250,110")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("path")
                    .attr("class","dv1-anntn-3-path2 annotation-path")
                    .attr("d", "M270,200L390,110L450,110")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
                
                dv1_anntn_group
                    .append("path")
                    .attr("class","dv1-anntn-3-path3 annotation-path")
                    .attr("d", "M360,200L450,110L500,110")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-3-text1 annotation-text-title")
                    .attr("x", 100)
                    .attr("y", 60)
                    .text("India")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
                
                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-3-text2 annotation-text")
                    .attr("x", 100)
                    .attr("y", 80)
                    .text("With fiertility rate closer")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-3-text3 annotation-text")
                    .attr("x", 100)
                    .attr("y", 100)
                    .text("to rest of the contries")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                
                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-3-text4 annotation-text-title")
                    .attr("x", 390)
                    .attr("y", 60)
                    .text("Pakistan & Nigeria")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-3-text5 annotation-text")
                    .attr("x", 390)
                    .attr("y", 80)
                    .text("Contries with higher")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

                dv1_anntn_group
                    .append("text")
                    .attr("class","dv1-anntn-3-text6 annotation-text")
                    .attr("x", 390)
                    .attr("y", 100)
                    .text("fertility rate")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")
            }
            
        }

    </script>
    <script>


        // set the dimensions and margins of the graph
        var dv2_margin = {top: 40, right: 30, bottom: 40, left: 70},
            dv2_width = 550 - dv2_margin.left - dv2_margin.right,
            dv2_height = 550 - dv2_margin.top - dv2_margin.bottom;
        
        playLineChart();

        function playLineChart() {
            // append the svg object to the body of the page
            //Reset the canvas
            d3.select("#scene_1_dv2").selectAll("*").remove()
            var dv2_svg = d3.select("#scene_1_dv2")
                        .append("svg")
                        .attr("class","dv2-svg1")
                        .attr("width", dv2_width + dv2_margin.left + dv2_margin.right)
                        .attr("height", dv2_height + dv2_margin.top + dv2_margin.bottom)
                        .append("g")
                        .attr("class","dv2 svg1 group1")
                        .attr("transform","translate(" + dv2_margin.left + "," + dv2_margin.top + ")");
            
            dv2_annotations();

            var dv2_tooltip = d3.select('#scene_1_dv2')
                    .append('div')
                    .attr('class', 'dv2 tooltip')
                    .style('display', 'none');

            var dv2_url = "https://raw.githubusercontent.com/rajlakshmank/rajlakshmank.github.io/master/data/top-10-countries-population-growth-data.csv"
            //Read the data
            d3.csv(dv2_url, function(dv2_data) {
            
                console.log(dv2_data);
                // group the data: I want to draw one line per group
                var dv2_sumstat = d3.nest() // nest function allows to group the calculation per level of a factor
                                .key(function(d) { return d.country;})
                                .entries(dv2_data);
            
                // Add X axis --> it is a date format
                var dv2_x = d3.scaleLinear()
                        .domain(d3.extent(dv2_data, function(d) { return d.year; }))
                        .range([ 0, dv2_width ]);
                    
                dv2_svg
                    .append("g")
                    .attr("class","dv2 X-axis")
                    .attr("transform", "translate(0," + dv2_height + ")")
                    .call(d3.axisBottom(dv2_x).ticks(10))
                    .selectAll("text")
                    .attr("class","graph_axis_text")
                
                //X axis title
                dv2_svg
                    .append("text")
                    .attr("class","graph_axis_title")
                    .attr("x", dv2_width/2)
                    .attr("y", dv2_height + dv2_margin.bottom)
                    .text("Year");
            
                // Add Y axis
                var dv2_y = d3.scaleLinear()
                        .domain([d3.min(dv2_data, function(d) { return +d.population_growth_rate; })-1, d3.max(dv2_data, function(d) { return +d.population_growth_rate; })])
                        .range([ dv2_height, 0 ]);
                dv2_svg
                    .append("g")
                    .attr("class","dv2 Y-axis")
                    .call(d3.axisLeft(dv2_y))
                    .selectAll("text")
                    .attr("class","graph_axis_text")

                //Y-axis title
                dv2_svg
                    .append("text")
                    .attr("class","graph_axis_title")
                    .attr("transform", "rotate(-90)")
                    .attr("y", -dv2_margin.left+20)
                    .attr("x", -dv2_margin.top-60)
                    .text("Population growth rate");
            
                // color palette
                var dv2_res = dv2_sumstat.map(function(d){ return d.key }) // list of group names
                /*
                var color = d3.scaleOrdinal()
                    .domain(res)
                    .range(['#e41a1c','#377eb8','#4daf4a','#984ea3','#ff7f00','#ffff33','#a65628','#f781bf','#999999'])
                */
                //var dv2_color = d3.scaleOrdinal(d3.schemeTableau10);
                var dv2_color = d3.scaleOrdinal(["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"]);
                // Draw the line
                dv2_svg
                    .selectAll(".line")
                    .data(dv2_sumstat)
                    .enter()
                    .append("path")
                    .attr("class","dv2-graph-line")
                    .attr("fill", "none")
                    .attr("stroke", function(d){ return dv2_color(d.key) })
                    .attr("stroke-width", 3)
                    .attr("d", function(d){
                    return d3.line()
                        .x(function(d) { return dv2_x(d.year); })
                        .y(function(d) { return dv2_y(+d.population_growth_rate); })
                        (d.values)
                    })
                    .on("mouseover", dv2_onMouseOver)
                    .on("mouseout", dv2_OnMouseOut)

                function dv2_onMouseOver() {
                    d3.select(this)
                        .attr("stroke", "black")
                        .attr("stroke-width", 5);
                    var d = d3.select(this).data()[0]
                    dv2_tooltip
                        .style('display', 'inline')
                        .html('Country ' + d.key)
                        .style('left', (d3.event.pageX))
                        .style('top', (d3.event.pageY));
                }
                function dv2_OnMouseOut() {
                    d3.select(this)
                        .attr("stroke", function(d) { return dv2_color(d.key); })
                        .attr("stroke-width", 3);
                    dv2_tooltip.style('display', 'none');
                    
                }
            
            })
        }

        function dv2_annotations() {
            d3.select(".dv2-svg1").select(".dv2-anntn-group").remove()
             // Graph1 annotations

            var dv2_anntn_group = d3.select(".dv2-svg1").append("g").attr("class","dv2-anntn-group");

            var ant_delay = 4000;
            dv2_anntn_group
                    .append("path")
                    .attr("class","dv2-anntn-1-path1 annotation-path")
                    .attr("d", "M240,45L450,45L510,100")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

            dv2_anntn_group
                    .append("path")
                    .attr("class","dv2-anntn-2-path1 annotation-path")
                    .attr("d", "M140,480L380,480L510,390")
                    .style("visibility","hidden")
                    .transition()
                    .delay(ant_delay)
                    .style("visibility","visible")

            dv2_anntn_group
                //.select(".dv2-svg1")
                .append("rect")
                .attr("class","dv2-anntn-1-rect annotation-rect")
                .attr("x",510)
                .attr("y",100)
                .attr("height",80)
                .attr("width",20)
                .style("visibility","hidden")
                .transition()
                .delay(ant_delay)
                .style("visibility","visible")

            dv2_anntn_group
                .append("text")
                .attr("class","dv2-anntn-1-text1 annotation-text-title")
                .attr("x", 240)
                .attr("y", 15)
                .text("Pakistan & Nigeria")
                .style("visibility","hidden")
                .transition()
                .delay(ant_delay)
                .style("visibility","visible")
            
            dv2_anntn_group
                .append("text")
                .attr("class","dv2-anntn-1-text2 annotation-text")
                .attr("x", 240)
                .attr("y", 35)
                .text("Growth decline is slower then rest")
                .style("visibility","hidden")
                .transition()
                .delay(ant_delay)
                .style("visibility","visible")

            dv2_anntn_group
                //.select(".dv2-svg1")
                .append("rect")
                .attr("class","dv2-anntn-2-rect annotation-rect")
                .attr("x",510)
                .attr("y",250)
                .attr("height",140)
                .attr("width",20)
                .style("visibility","hidden")
                .transition()
                .delay(ant_delay)
                .style("visibility","visible")

            dv2_anntn_group
                .append("text")
                .attr("class","dv2-anntn-2-text1 annotation-text")
                .attr("x", 140)
                .attr("y", 450)
                .text("Countries showing promissing growth")
                .style("visibility","hidden")
                .transition()
                .delay(ant_delay)
                .style("visibility","visible")
            
            dv2_anntn_group
                .append("text")
                .attr("class","dv2-anntn-2-text2 annotation-text")
                .attr("x", 140)
                .attr("y", 470)
                .text("decline, whihch includes India")
                .style("visibility","hidden")
                .transition()
                .delay(ant_delay)
                .style("visibility","visible")
            
        }

        
    </script>
</html>